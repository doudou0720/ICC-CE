<UserControl x:Class="Ink_Canvas.Windows.SettingsViews.StartupPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Ink_Canvas.Windows.SettingsViews"
             xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
             mc:Ignorable="d" 
             d:DesignHeight="950" d:DesignWidth="640">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="ComboBoxStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <Style x:Key="ToggleSwitchStyle" TargetType="Border">
                <Setter Property="Width" Value="48"/>
                <Setter Property="Height" Value="25"/>
                <Setter Property="CornerRadius" Value="12"/>
                <Setter Property="Padding" Value="3,0"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="VerticalAlignment" Value="Center"/>
                <Setter Property="HorizontalAlignment" Value="Right"/>
                <Setter Property="Margin" Value="0,0,15,0"/>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    <ScrollViewer ScrollChanged="ScrollViewerEx_ScrollChanged" IsManipulationEnabled="True" Name="ScrollViewerEx" IsDeferredScrollingEnabled="True" VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Disabled" IsTabStop="False" TabIndex="-1" Margin="0,0,2,2">
        <StackPanel Margin="60,12,60,24">
            <Border BorderBrush="#e6e6e6" BorderThickness="1.25,1.25,1.25,4" CornerRadius="8">
                <StackPanel Orientation="Vertical">
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="窗口无焦点模式" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="窗口失去焦点时仍可接收输入" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchNoFocusMode" Style="{StaticResource ToggleSwitchStyle}" Background="#e1e1e1" Tag="NoFocusMode" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Left" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="窗口无边框模式" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="隐藏窗口边框，提供更沉浸的体验" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchWindowMode" Style="{StaticResource ToggleSwitchStyle}" Background="#3584e4" Tag="WindowMode" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Right" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="窗口置顶" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="窗口始终显示在其他窗口之上" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchAlwaysOnTop" Style="{StaticResource ToggleSwitchStyle}" Background="#3584e4" Tag="AlwaysOnTop" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Right" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54" x:Name="UIAccessTopMostPanel" Visibility="Collapsed">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="UIA置顶" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="使用UIA方式实现置顶，需要管理员权限" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchUIAccessTopMost" Style="{StaticResource ToggleSwitchStyle}" Background="#e1e1e1" Tag="UIAccessTopMost" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Left" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                </StackPanel>
            </Border>
            
            <Border Margin="0,25,0,0" BorderBrush="#e6e6e6" BorderThickness="1.25,1.25,1.25,4" CornerRadius="8">
                <StackPanel Orientation="Vertical">
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="自动检查更新" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="定期检查是否有新版本可用" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchIsAutoUpdate" Style="{StaticResource ToggleSwitchStyle}" Background="#3584e4" Tag="IsAutoUpdate" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Right" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="静默更新" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="在软件不使用时自动安装更新，无需手动操作" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchIsAutoUpdateWithSilence" Style="{StaticResource ToggleSwitchStyle}" Background="#3584e4" Tag="IsAutoUpdateWithSilence" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Right" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="更新通道" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="选择更新通道：稳定版提供可靠更新，测试版提供新功能抢先体验" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <WrapPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,15,0">
                            <Border x:Name="UpdateChannelReleaseBorder" Padding="13,7" CornerRadius="8" Cursor="Hand" Tag="UpdateChannel_Release" Margin="0,0,8,8" MouseLeftButtonDown="OptionButton_Click">
                                <TextBlock Foreground="#2e3436" FontSize="14" FontWeight="Bold" Text="稳定版"/>
                            </Border>
                            <Border x:Name="UpdateChannelBetaBorder" Padding="13,7" CornerRadius="8" Cursor="Hand" Tag="UpdateChannel_Beta" Margin="0,0,8,8" MouseLeftButtonDown="OptionButton_Click">
                                <TextBlock Foreground="#2e3436" FontSize="14" Text="测试版"/>
                            </Border>
                        </WrapPanel>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="手动更新" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="点击后立即检查并下载最新版本" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Button x:Name="ManualUpdateButton" Content="手动更新" Width="120" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,15,0" Padding="12,6" Click="ManualUpdateButton_Click"/>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="版本修复" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="根据当前选择的通道下载最新版本并执行安装，可用于修复损坏的安装" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Button x:Name="FixVersionButton" Content="版本修复" Width="120" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,15,0" Padding="12,6" Click="FixVersionButton_Click"/>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="历史版本回滚" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="回滚到之前的版本" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Button x:Name="HistoryRollbackButton" Content="历史版本回滚" Width="120" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,15,0" Padding="12,6" Click="HistoryRollbackButton_Click"/>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Margin="18,12,15,12" x:Name="AutoUpdateTimePeriodBlock">
                        <StackPanel>
                            <TextBlock Text="静默更新时间段" FontSize="15" FontWeight="Bold" Foreground="#2e3436" Margin="0,0,0,12"/>
                            <StackPanel>
                                <StackPanel Orientation="Vertical" Margin="0,0,0,12">
                                    <TextBlock Text="起始时间" FontSize="14" Foreground="#2e3436" Margin="0,0,0,8"/>
                                    <ComboBox x:Name="AutoUpdateWithSilenceStartTimeComboBox" 
                                              Style="{StaticResource ComboBoxStyle}"
                                              ItemContainerStyle="{StaticResource ComboBoxItemStyle}"
                                              HorizontalAlignment="Left"
                                              Width="150"
                                              SelectedIndex="6"
                                              SelectionChanged="AutoUpdateWithSilenceStartTimeComboBox_SelectionChanged">
                                        <ComboBoxItem Content="00:00" Tag="00"/>
                                        <ComboBoxItem Content="01:00" Tag="01"/>
                                        <ComboBoxItem Content="02:00" Tag="02"/>
                                        <ComboBoxItem Content="03:00" Tag="03"/>
                                        <ComboBoxItem Content="04:00" Tag="04"/>
                                        <ComboBoxItem Content="05:00" Tag="05"/>
                                        <ComboBoxItem Content="06:00" Tag="06" IsSelected="True"/>
                                        <ComboBoxItem Content="07:00" Tag="07"/>
                                        <ComboBoxItem Content="08:00" Tag="08"/>
                                        <ComboBoxItem Content="09:00" Tag="09"/>
                                        <ComboBoxItem Content="10:00" Tag="10"/>
                                        <ComboBoxItem Content="11:00" Tag="11"/>
                                        <ComboBoxItem Content="12:00" Tag="12"/>
                                        <ComboBoxItem Content="13:00" Tag="13"/>
                                        <ComboBoxItem Content="14:00" Tag="14"/>
                                        <ComboBoxItem Content="15:00" Tag="15"/>
                                        <ComboBoxItem Content="16:00" Tag="16"/>
                                        <ComboBoxItem Content="17:00" Tag="17"/>
                                        <ComboBoxItem Content="18:00" Tag="18"/>
                                        <ComboBoxItem Content="19:00" Tag="19"/>
                                        <ComboBoxItem Content="20:00" Tag="20"/>
                                        <ComboBoxItem Content="21:00" Tag="21"/>
                                        <ComboBoxItem Content="22:00" Tag="22"/>
                                        <ComboBoxItem Content="23:00" Tag="23"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Orientation="Vertical" Margin="0,0,0,0">
                                    <TextBlock Text="终止时间" FontSize="14" Foreground="#2e3436" Margin="0,0,0,8"/>
                                    <ComboBox x:Name="AutoUpdateWithSilenceEndTimeComboBox" 
                                              Style="{StaticResource ComboBoxStyle}"
                                              ItemContainerStyle="{StaticResource ComboBoxItemStyle}"
                                              HorizontalAlignment="Left"
                                              Width="150"
                                              SelectedIndex="22"
                                              SelectionChanged="AutoUpdateWithSilenceEndTimeComboBox_SelectionChanged">
                                        <ComboBoxItem Content="00:00" Tag="00"/>
                                        <ComboBoxItem Content="01:00" Tag="01"/>
                                        <ComboBoxItem Content="02:00" Tag="02"/>
                                        <ComboBoxItem Content="03:00" Tag="03"/>
                                        <ComboBoxItem Content="04:00" Tag="04"/>
                                        <ComboBoxItem Content="05:00" Tag="05"/>
                                        <ComboBoxItem Content="06:00" Tag="06"/>
                                        <ComboBoxItem Content="07:00" Tag="07"/>
                                        <ComboBoxItem Content="08:00" Tag="08"/>
                                        <ComboBoxItem Content="09:00" Tag="09"/>
                                        <ComboBoxItem Content="10:00" Tag="10"/>
                                        <ComboBoxItem Content="11:00" Tag="11"/>
                                        <ComboBoxItem Content="12:00" Tag="12"/>
                                        <ComboBoxItem Content="13:00" Tag="13"/>
                                        <ComboBoxItem Content="14:00" Tag="14"/>
                                        <ComboBoxItem Content="15:00" Tag="15"/>
                                        <ComboBoxItem Content="16:00" Tag="16"/>
                                        <ComboBoxItem Content="17:00" Tag="17"/>
                                        <ComboBoxItem Content="18:00" Tag="18"/>
                                        <ComboBoxItem Content="19:00" Tag="19"/>
                                        <ComboBoxItem Content="20:00" Tag="20"/>
                                        <ComboBoxItem Content="21:00" Tag="21"/>
                                        <ComboBoxItem Content="22:00" Tag="22" IsSelected="True"/>
                                        <ComboBoxItem Content="23:00" Tag="23"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                            <TextBlock Margin="0,8,0,0" Text="若终止时间小于起始时间，即将终止时间视为第二天的时间。若起始时间与终止时间相同，即视为全天候时间。" 
                                       TextWrapping="Wrap" Foreground="#9a9996" FontSize="11"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>
            
            <Border Margin="0,25,0,0" BorderBrush="#e6e6e6" BorderThickness="1.25,1.25,1.25,4" CornerRadius="8">
                <StackPanel Orientation="Vertical">
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="开机时运行" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="系统启动时自动运行软件" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchRunAtStartup" Style="{StaticResource ToggleSwitchStyle}" Background="#3584e4" Tag="RunAtStartup" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Right" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                    <Border Height="1" Background="#ebebeb"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" Margin="18,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="开机运行后收纳到侧边栏" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="开机启动后自动收纳到侧边栏" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchFoldAtStartup" Style="{StaticResource ToggleSwitchStyle}" Background="#3584e4" Tag="FoldAtStartup" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Right" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                </StackPanel>
            </Border>
            
            <Border Margin="0,25,0,0" BorderBrush="#e6e6e6" BorderThickness="1.25,1.25,1.25,4" CornerRadius="8">
                <StackPanel Orientation="Vertical" Margin="18,18,18,18">
                    <TextBlock Text="选择软件运行模式。仅PPT模式下，软件将完全隐藏，仅在PPT放映时出现。（实验性功能，可能不稳定。）" 
                               TextWrapping="Wrap" Foreground="#9a9996" FontSize="11" Margin="0,0,0,12"/>
                    <Grid Height="54">
                        <StackPanel Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock Foreground="#2e3436" FontSize="14.5" Text="仅PPT模式" HorizontalAlignment="Left"/>
                            <TextBlock Foreground="#9a9996" FontSize="11" Margin="0,3.5,0,0" Text="启用后，软件将完全隐藏，仅在PPT放映时出现" HorizontalAlignment="Left"/>
                        </StackPanel>
                        <Border x:Name="ToggleSwitchMode" Style="{StaticResource ToggleSwitchStyle}" Background="#e1e1e1" Tag="Mode" MouseLeftButtonDown="ToggleSwitch_Click">
                            <Border Width="19" Height="19" Background="White" CornerRadius="10" HorizontalAlignment="Left" VerticalAlignment="Center" IsHitTestVisible="False">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="4" Direction="-45" Color="Black" Opacity="0.3" ShadowDepth="0"/>
                                </Border.Effect>
                            </Border>
                        </Border>
                    </Grid>
                </StackPanel>
            </Border>
            
            <Border Margin="0,25,0,0" BorderBrush="#e6e6e6" BorderThickness="1.25,1.25,1.25,4" CornerRadius="8">
                <StackPanel Orientation="Vertical" Margin="18,18,18,18">
                    <TextBlock Text="通过插件扩展InkCanvas的功能。您可以启用或禁用插件，或加载自定义插件。" 
                               TextWrapping="Wrap" Foreground="#9a9996" FontSize="11" Margin="0,0,0,12"/>
                    <Button x:Name="BtnOpenPluginManager" Content="打开插件管理器" 
                            HorizontalAlignment="Left" Padding="15,5"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
